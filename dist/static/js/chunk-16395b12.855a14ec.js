(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16395b12"],{"1ced":function(e,t,a){},"237d":function(e,t,a){},3012:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("breadcrumb-wrapper",{scopedSlots:e._u([{key:"left",fn:function(){return[a("el-breadcrumb",{staticClass:"app-breadcrumb",attrs:{separator:"/"}},[a("transition-group",{attrs:{name:"breadcrumb"}},["Article"==e.fromPage?a("el-breadcrumb-item",{key:"1"},[a("router-link",{attrs:{to:"/article?id="+e.sid+"&uid="+e.uid}},[e._v("我添加的文章")])],1):e._e(),e._v(" "),"Database"==e.fromPage?a("el-breadcrumb-item",{key:"2"},[a("router-link",{attrs:{to:"/database?id="+e.sid}},[e._v("资料库")])],1):e._e(),e._v("database\r\n                "),"ArticleDetail"==e.fromPage?a("el-breadcrumb-item",{key:"3"},[a("router-link",{attrs:{to:"/articleDetail/"+e.article.id+"?fromPage=Article&sid="+e.sid}},[e._v("文章详情")])],1):e._e(),e._v(" "),"DataDetail"==e.fromPage?a("el-breadcrumb-item",{key:"4"},[a("router-link",{attrs:{to:"/dataDetail/"+e.article.id+"?fromPage=Database&sid="+e.sid}},[e._v("资料详情")])],1):e._e(),e._v(" "),a("el-breadcrumb-item",{key:"5"},["EditArticle"==e.name?a("span",[e._v("编辑文章")]):e._e(),e._v(" "),"AddArticle"==e.name?a("span",[e._v("添加文章")]):e._e(),e._v(" "),"AddData"==e.name?a("span",[e._v("添加资料")]):e._e(),e._v(" "),"EditData"==e.name?a("span",[e._v("编辑资料")]):e._e()])],1)],1)]},proxy:!0},{key:"right",fn:function(){return[a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.publish}},[e._v("\r\n                    发布\r\n                ")])]},proxy:!0}])}),e._v(" "),a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"w750"},[a("el-input",{attrs:{maxlength:"60",placeholder:"文章标题不超过60个字符"},model:{value:e.article.title,callback:function(t){e.$set(e.article,"title",t)},expression:"article.title"}})],1),e._v(" "),a("div",{staticClass:"editorBox w750 "},[a("textarea",{attrs:{id:"editor1"}}),e._v(" "),a("div",{staticClass:"contentNum"},[e._v("字数统计："+e._s(e.contentNum))])])])],1)},n=[],s=(a("608b"),a("34a3"),a("7364"),a("9584"),a("5f87")),r=a("ed08"),o=a("4f67"),c=a("d3fe"),l=Object(s["a"])(),d=Object(r["c"])(),u=("".concat("/api","/user/info/upload?token=").concat(l,"&lang=").concat(d),{name:"AddEditArticle",components:{BreadcrumbWrapper:c["a"]},data:function(){return{title:"",loading:!1,name:"",uid:this.$store.getters.user.id,fromPage:this.$route.query.fromPage,sid:"",contentNum:0,article:{title:"",content:"",sid:void 0}}},watch:{$route:{handler:function(e){var t=this.$route.query.sid;this.article.sid=t},immediate:!0}},mounted:function(){var e=this.$route.name,t=this.$route.query.sid;this.name=e,this.sid=t,this.ckeditor()},methods:{ckeditor:function(){var e=this;CKEDITOR.replace("editor1",{toolbar:[{name:"document",items:["Print"]},{name:"clipboard",items:["Undo","Redo"]},{name:"styles",items:["Format","Font","FontSize"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","RemoveFormat","CopyFormatting"]},{name:"colors",items:["TextColor","BGColor"]},{name:"align",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"links",items:["Link","Unlink"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote"]},{name:"insert",items:["Image","Table"]},{name:"tools",items:["Maximize"]},{name:"editing",items:["Scayt"]}],customConfig:"",disallowedContent:"img{width,height,float}",extraAllowedContent:"img[width,height,align]",fileTools_defaultFileName:"file",fileName:"file",image_previewText:" ",extraPlugins:"tableresize,uploadimage,uploadfile",uploadUrl:"`${process.env.VUE_APP_BASE_API}/user/info/upload?token=${token}&lang=${lang}`",filebrowserImageUploadUrl:"".concat("/api","/user/info/upload?token=").concat(l,"&lang=").concat(d),height:800,contentsCss:["https://cdn.ckeditor.com/4.8.0/full-all/contents.css","mystyles.css"],bodyClass:"document-editor",format_tags:"p;h1;h2;h3;pre",removeDialogTabs:"image:advanced;link:advanced",stylesSet:[{name:"Marker",element:"span",attributes:{class:"marker"}},{name:"Cited Work",element:"cite"},{name:"Inline Quotation",element:"q"},{name:"Special Container",element:"div",styles:{padding:"5px 10px",background:"#eee",border:"1px solid #ccc"}},{name:"Compact table",element:"table",attributes:{cellpadding:"5",cellspacing:"0",border:"1",bordercolor:"#ccc"},styles:{"border-collapse":"collapse"}},{name:"Borderless Table",element:"table",styles:{"border-style":"hidden","background-color":"#E6E6FA"}},{name:"Square Bulleted List",element:"ul",styles:{"list-style-type":"square"}}]}),CKEDITOR.on("instanceReady",function(t){e.find()}),CKEDITOR.instances["editor1"].on("change",function(t){e.contentNum=e.getText().length}),CKEDITOR.instances["editor1"].on("fileUploadRequest",function(e){var t=e.data.fileLoader,a=new FormData,i=t.xhr;i.open("post",t.uploadUrl,!0),a.append("file",t.file,t.fileName),t.xhr.send(a),e.stop()},null,null,4),CKEDITOR.instances["editor1"].on("fileUploadResponse",function(e){e.stop();var t=e.data,a=t.fileLoader.xhr,i=JSON.parse(a.responseText);"200"===i.code?(t.message=i.message,e.cancel()):t.url=i.data.url})},setContent:function(e){CKEDITOR.instances["editor1"].setData(e)},getContent:function(){return CKEDITOR.instances["editor1"].getData()},getText:function(){return CKEDITOR.instances["editor1"].document.getBody().getText().trim()},publish:function(){var e=this,t=this.article.title.length,a=this.sid;if(t>0){var i=this.name,n=this.getText().length,s=this.getContent();n>0?("EditArticle"==i&&(this.article.content=s,this.loading=!0,this.$store.dispatch("article/articleModify",this.article).then(function(t){e.loading=!1,e.$router.push("/article?id="+e.article.subject_id+"&uid="+e.uid),e.$message({message:"修改文章成功",type:"success"})}).catch(function(){e.loading=!1})),"AddArticle"==i&&(this.article.content=s,this.article.sid=this.sid,this.loading=!0,this.$store.dispatch("article/articleAdd",this.article).then(function(t){e.loading=!1,e.$router.push("/article?id="+a+"&uid="+e.uid),e.$message({message:"发布文章成功",type:"success"})}).catch(function(){e.loading=!1})),"AddData"==i&&(this.article.content=s,this.article.sid=this.sid,this.loading=!0,this.$store.dispatch("article/materialAdd",this.article).then(function(t){e.loading=!1,e.$router.push("/database?id="+a),e.$message({message:"发布资料成功",type:"success"})}).catch(function(){e.loading=!1})),"EditData"==i&&(this.article.content=s,this.loading=!0,this.$store.dispatch("article/materialModify",this.article).then(function(t){e.loading=!1,e.$router.push("/database?id="+e.article.subject_id),e.$message({message:"修改资料成功",type:"success"})}).catch(function(){e.loading=!1}))):this.$message({message:"内容不能为空！",type:"error"})}else this.$message({message:"标题不能为空！",type:"error"})},find:function(){var e=this,t=this.$route.params.id;"EditArticle"==this.name&&t&&this.$store.dispatch("article/articleGet",{id:t}).then(function(t){var a=t.data.content;e.article=t.data,e.setContent(a)}).catch(function(e){console.error(e)}),"EditData"==this.name&&t&&this.$store.dispatch("article/materialGet",{id:t}).then(function(t){var a=t.data.content;e.article=t.data,e.setContent(a)}).catch(function(e){console.error(e)})}}}),m=u,h=(a("9bff"),a("17cc")),p=Object(h["a"])(m,i,n,!1,null,"5215bc7d",null);t["default"]=p.exports},"513e":function(e,t,a){"use strict";var i=a("237d"),n=a.n(i);n.a},"9bff":function(e,t,a){"use strict";var i=a("1ced"),n=a.n(i);n.a},d3fe:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"breadcrumbBox app-container"},[a("div",{staticClass:"flexBox",staticStyle:{"align-items":"center"}},[a("div",[e._t("left")],2),e._v(" "),a("div",{staticClass:"flexItem",staticStyle:{"text-align":"right"}},[e._t("right")],2)])])},n=[],s={name:"BreadcrumbWrapper"},r=s,o=(a("513e"),a("17cc")),c=Object(o["a"])(r,i,n,!1,null,"9c156d0c",null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-16395b12.855a14ec.js.map